<!DOCTYPE html>
<html>
<head>
  <title>Landing Page Automatizada</title>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 30px;
      background-color: #f8f9fa;
    }
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eaeaea;
    }
    .header h1 {
      color: #2d3748;
      margin-bottom: 10px;
    }
    .links-container {
      display: grid;
      gap: 20px;
    }
    .link-item {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .link-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .link-title {
      font-size: 1.2rem;
      margin: 0;
    }
    .link-title a {
      color: #1a73e8;
      text-decoration: none;
      display: block;
      padding: 8px 0;
      transition: color 0.2s;
    }
    .link-title a:hover {
      color: #0d47a1;
      text-decoration: underline;
    }
    .link-url {
      display: block;
      font-size: 0.85rem;
      color: #5f6368;
      margin-top: 5px;
      word-break: break-all;
    }
    .footer {
      text-align: center;
      margin-top: 40px;
      color: #70757a;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Recursos Recomendados</h1>
    <p>Atualizado automaticamente conforme nossa base de dados</p>
  </div>
  
  <div id="links-container" class="links-container"></div>
  
  <div class="footer">
    <p>Esta página atualiza automaticamente a cada 5 minutos</p>
  </div>

  <script>
    // URL da planilha pública (SUBSTITUA PELA SUA URL)
    const SPREADSHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQQQwcE84wyqgyut6pu0pfKXDdQ5L4UC9lKKBoxBHi_N0gSuJd7JpGTx6uR3GGVB9SSPauMTrv0McIK/pub?gid=292424894&single=true&output=csv";

    // Sanitização básica para segurança
    function safeText(text) {
      if (!text) return '';
      return text
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
    }

    // Formatar URL para exibição
    function formatUrl(url) {
      try {
        const parsed = new URL(url);
        return `${parsed.hostname}${parsed.pathname}`;
      } catch {
        return url;
      }
    }

    // Buscar e processar dados
    function loadData() {
      // Adiciona timestamp para evitar cache
      const url = `${SPREADSHEET_URL}&t=${Date.now()}`;
      
      Papa.parse(url, {
        download: true,
        header: true,
        complete: (results) => {
          const container = document.getElementById('links-container');
          
          if(results.data.length > 0) {
            renderLinks(results.data);
          } else {
            container.innerHTML = '<p class="empty-message">Nenhum recurso disponível no momento.</p>';
          }
        },
        error: (error) => {
          console.error("Erro ao carregar dados:", error);
          document.getElementById('links-container').innerHTML = 
            '<p class="error-message">⚠️ Erro ao carregar os recursos. Atualize a página ou tente novamente mais tarde.</p>';
        }
      });
    }

    // Renderizar links na página
    function renderLinks(data) {
      const container = document.getElementById('links-container');
      container.innerHTML = "";

      data.forEach(row => {
        if (row.Título && row.Link) {
          const linkItem = document.createElement('div');
          linkItem.className = 'link-item';
          
          // Sanitiza os dados antes de inserir
          const titulo = safeText(row.Título);
          const link = safeText(row.Link);
          const displayUrl = formatUrl(link);
          
          linkItem.innerHTML = `
            <h3 class="link-title">
              <a href="${link}" target="_blank">${titulo}</a>
              <span class="link-url">${displayUrl}</span>
            </h3>
          `;
          container.appendChild(linkItem);
        }
      });
    }

    // Carregar dados ao iniciar e a cada 5 minutos
    window.onload = loadData;
    setInterval(loadData, 300000);  // Atualiza a cada 5 minutos
  </script>
</body>
</html>


